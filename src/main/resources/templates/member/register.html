<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
	<title>register</title>
	<script src="/js/jquery-3.6.1.min.js"></script>
	<script>
		function execDaumPostcode() {
			new daum.Postcode({
				oncomplete: function(data) {
					// 팝업에서 검색결과 항목을 클릭했을때 실행할 코드를 작성하는 부분.

					// 도로명 주소의 노출 규칙에 따라 주소를 조합한다.
					// 내려오는 변수가 값이 없는 경우엔 공백('')값을 가지므로, 이를 참고하여 분기 한다.
					var fullRoadAddr = data.roadAddress; // 도로명 주소 변수
					var extraRoadAddr = ''; // 도로명 조합형 주소 변수

					// 법정동명이 있을 경우 추가한다. (법정리는 제외)
					// 법정동의 경우 마지막 문자가 "동/로/가"로 끝난다.
					if (data.bname !== '' && /[동|로|가]$/g.test(data.bname)){
						extraRoadAddr += data.bname;
					}
					// 건물명이 있고, 공동주택일 경우 추가한다.
					if (data.buildingName !== '' && data.apartment === 'Y'){
						extraRoadAddr += (extraRoadAddr !== '' ? ', ' + data.buildingName : data.buildingName);
					}
					// 도로명, 지번 조합형 주소가 있을 경우, 괄호까지 추가한 최종 문자열을 만든다.
					if (extraRoadAddr !== ''){
						extraRoadAddr = ' (' + extraRoadAddr + ')';
					}
					// 도로명, 지번 주소의 유무에 따라 해당 조합형 주소를 추가한다.
					if (fullRoadAddr !== ''){
						fullRoadAddr += extraRoadAddr;
					}

					document.getElementById('zipcode').value = data.zonecode;
					document.getElementById('roadAddress').value = fullRoadAddr;
					document.getElementById('jibunAddress').value = data.jibunAddress;

				}
			}).open();
		}
	</script>
</head>

	<form th:action="@{/member/register}" th:onsubmit="return checkFirmValidation()" method="post">
		<div align="center">
	<h4>회원 가입</h4>
    <div>아이디<span>*</span></div>
		<input type="text" id="userId" name="userId" placeholder="아이디 입력(6~20자이내)" required>&emsp;<br>
	<label id="isvalidMsg"></label>
	
	<div>패스워드<span>*</span></div>
		<input type="password" id="password" name="password" placeholder="패스워드 입력(문자,숫자,특수문자 포함6~20자)" required>
	<br><br>
	<div>패스워드 재확인<span>*</span></div>
		<input type="text" id="confirmPassword" placeholder="패스워드 재입력"><br>
	<label id="isvalidPasswordMsg"></label>
	
	<div>이름<span>*</span></div>
		<input type="text" id="name" name="name" placeholder="이름을 입력해주세요" required>
	<br><br>
	<div>전화번호<span>*</span></div>
		<input type="text" name="phoneNumber" placeholder="'-'없이 숫자만 입력" required>
	<div>SMS 마케팅 수신 동의여부<span>*</span></div>
		<input type="checkbox" id="smsstsYn" name="smsstsYn" value="y">
	
	<div>이메일<span>*</span></div>
		<input type="text" name="email" placeholder="you@example.com">
	<div>이메일 마케팅 수신 동의여부<span>*</span></div>
	<input type="checkbox" id="emailstsYn" name="emailstsYn" value="y">
	
	<div>주소<span>*</span></p>
		<input type="text" id="zipCode" name="zipCode"  placeholder="우편번호 입력">
		<input type="button" th:onclick="javascript:execDaumPostcode()" value="검색">
	</div>
	<br><br>
		<input type="text" placeholder="도로명 주소" id="roadAddress" name="roadAddress"><br><br>
		<input type="text" placeholder="지번 주소" id="jibunAddress" name="jibunAddress"><br><br>
		<input type="text" placeholder="상세 주소" id="namujiAddress" name="namujiAddress" >
    <br>
    <div>
		<input type="checkbox" name="personalInfoYn" value="y">개인 정보 수집 및 이용 동의(필수)<br>
		<textarea rows="5" cols="50" disabled>
     개인정보보호법에 따라  '중고올래'  회원가입 신청하시는 분께 수집하는 개인정보의 항목, 개인정보의 수집 및 이용목적, 개인정보의 보유 및 이용기간, 동의 거부권 및 동의 거부 시 불이익에 관한 사항을 안내 드리오니 자세히 읽은 후 동의하여 주시기 바랍니다.
	    </textarea>
	</div>
	<input type="submit" value="회원가입하기">
		</div>
	</form>
</div>
<script>
	
	var formCheckId = false;
	var formCheckPasswd = false;
	
	
       $(function(){
		$("#userId").blur(function(){
			var userId = $(this).val();
			if(userId ==''){
				$("#isvalidMsg").html("<span style='color:red;'>아이디를 입력하세요!</span>");
				formCheckId = false;
				return;
			}
			// AJAX전송(단일데이터)
			$.ajax({
				type : "post",
				url : "/member/dupleCheckId",
				data : {"userId" : userId},
				success : function(validateId){
					if(validateId == "y"){
						$("#isvalidMsg").html("<span style='color:green;'>사용 가능한 아이디입니다.</span>");
						formCheckId = true;
					}
					else{
						$("#isvalidMsg").html("<span style='color:red;'>이미 사용중인 아이디입니다.</span>");
						formCheckId = false;
					}
				}
			});
		});
		
		$("#confirmPassword").blur(function(){
			var password = $("#password").val();
			var confirmPassword = $("#confirmPassword").val();
			
			if(password == confirmPassword){
				$("#isvalidPasswordMsg").html("<span style='color:green;'>패스워드가 일치합니다.</span>");
				formCheckPasswd = true;
			}
			else{
				$("#isvalidPasswordMsg").html("<span style='color:red;'>패스워드가 일치하지 않습니다.</span>");
				formCheckPasswd  = false;
			}
			
		});
	});
	
	function checkFirmValidation(){
		if(!formCheckId){
			alert("아이디 중복 확인을 해주세요!");
			$("#userId").focus();
			return false;
		}
		if(!formCheckPasswd){
			alert("패스워드 재확인 해주세요!");
			$("#password").focus();
			return false;
		}
	}
	
</script>
</html>